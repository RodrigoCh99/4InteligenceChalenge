---
output: html_notebook
---

## **Exploratory Data Analysis - Brazilian Imports/Exports**

official data source for brazilian exports e imports, maintened by the government. The dataset contains all trackings of monthly imports and exports of a range of products (soybeans, soybean meal, soybean oil, corn, wheat and sugar), by brazilian states, by routes (air, sea, ground, etc) e from/to which country;

**Importing:**
```{r message=FALSE, warning=FALSE}
# useful library 
# install.packages("tidyverse")

# loading library:
library("tidyverse")

# importing data from csv file:
df <- read.table('data/data_comexstat.csv',
                 header = TRUE,
                 sep = ',',
                 dec = '.')
```

**Examine basic dataset information:**
```{r}
# first rows of dataframe:
head(df)
```

## **Questions:**

##### **Show the evolution of total monthly and total annual exports from Brazil (all states and to everywhere) of ‘soybeans’, ‘soybean oil’ and ‘soybean meal’**

Division in import set and export set:
```{r}
# import set
df_import <- subset(df, df$type == 'Import')
# removing useless column:
df_import <- df_import[-c(5)]
```

```{r}
# export set
df_export <- subset(df, df$type == 'Export')
# removing useless column:
df_export <- df_export[-c(5)]
```

converting data column to date:
```{r}
# converting date column to date type:
df_export$date <- as.Date(df_export$date,"%Y-%m-%d")
```

Group by state
```{r}
# dataframe groub by date and product:
month_sum <- df_export %>% 
  group_by(date, product) %>% 
    summarize(usd_return = sum(usd))

# df of month soybbeans
subset_soybeans <- subset(month_sum, month_sum$product == 'soybeans')
# removing useless column:
subset_soybeans <- subset_soybeans[-c(2)]

# df of month oil
subset_soybean_oil <- subset(month_sum, month_sum$product == 'soybean_oil')
# removing useless column:
subset_soybean_oil <- subset_soybean_oil[-c(2)]

# df of month meal
subset_soybean_meal <- subset(month_sum, month_sum$product == 'soybean_meal')
# removing useless column:
subset_soybean_meal <- subset_soybean_meal[-c(2)]

```

visualization:
```{r}
# function to fill values to month data:
new_fill <- function(x, df) {
  
  output = data.frame(Date=as.Date(character()), Value=numeric())
  
  for (i in 1:length(x)) {
    # print((x[i] == df$date[i]))
    
    output[i, 'Date'] = df$date[i]
    val <- match(x[i] == df$date[i])
    print(val)
    
    if (is.na(val) == FALSE) {
      output[i, 'Value'] = df$usd_return[i]
      
    } else {
      output[i, 'Value'] = NA
      
    }
  }
  
  return(output)
}

# sequence of months to plots:
seq_months <- seq(from = as.Date('1997-01-01'), to = as.Date('2019-12-01'), by = "month")

www <- new_fill(seq_months, subset_soybeans)


```

```{r}

seq_months[1] == subset_soybeans$date[1]
```